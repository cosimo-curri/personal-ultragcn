###################### UltraGCN ######################
Loading Configuration...
Computing \Omega for the item-item graph... 
i-i constraint matrix 0 ok
i-i constraint matrix 15000 ok
i-i constraint matrix 30000 ok
Computation \Omega OK!
store object in path = ./yelp2018_ii_neighbor_mat ok
store object in path = ./yelp2018_ii_constraint_mat ok
Load Configuration OK, show them below
Configuration:
{'embedding_dim': 64, 'ii_neighbor_num': 10, 'model_save_path': './ultragcn_yelp2018.pt', 'max_epoch': 2000, 'enable_tensorboard': True, 'initial_weight': 0.0001, 'dataset': 'yelp2018', 'gpu': '0', 'device': device(type='cuda', index=0), 'lr': 0.001, 'batch_size': 1024, 'early_stop_epoch': 15, 'w1': 1e-08, 'w2': 1.0, 'w3': 1e-08, 'w4': 1.0, 'negative_num': 800, 'negative_weight': 300.0, 'gamma': 0.0001, 'lambda': 0.0005, 'sampling_sift_pos': False, 'test_batch_size': 2048, 'topk': 20, 'user_num': 31668, 'item_num': 38048}
Total training batches = 1209
The time for epoch 0 is: train time = 00: 00: 46, test time = 00: 00: 10
Loss = 121.34798, F1-score: 0.007458 	 Precision: 0.00530	 Recall: 0.01257	NDCG: 0.01021
The time for epoch 5 is: train time = 00: 00: 46, test time = 00: 00: 10
Loss = 76.42798, F1-score: 0.007242 	 Precision: 0.00513	 Recall: 0.01234	NDCG: 0.00982
The time for epoch 10 is: train time = 00: 00: 45, test time = 00: 00: 09
Loss = 65.98972, F1-score: 0.007315 	 Precision: 0.00518	 Recall: 0.01242	NDCG: 0.01006
The time for epoch 15 is: train time = 00: 00: 45, test time = 00: 00: 10
Loss = 59.83310, F1-score: 0.016060 	 Precision: 0.01211	 Recall: 0.02382	NDCG: 0.02007
The time for epoch 20 is: train time = 00: 00: 46, test time = 00: 00: 10
Loss = 61.97752, F1-score: 0.024084 	 Precision: 0.01782	 Recall: 0.03712	NDCG: 0.03063
The time for epoch 25 is: train time = 00: 00: 47, test time = 00: 00: 10
Loss = 62.66932, F1-score: 0.029755 	 Precision: 0.02185	 Recall: 0.04663	NDCG: 0.03876
The time for epoch 30 is: train time = 00: 00: 47, test time = 00: 00: 10
Loss = 65.82378, F1-score: 0.034064 	 Precision: 0.02482	 Recall: 0.05427	NDCG: 0.04420
The time for epoch 35 is: train time = 00: 00: 47, test time = 00: 00: 10
Loss = 65.20579, F1-score: 0.037112 	 Precision: 0.02695	 Recall: 0.05955	NDCG: 0.04866
The time for epoch 40 is: train time = 00: 00: 47, test time = 00: 00: 10
Loss = 67.52218, F1-score: 0.039243 	 Precision: 0.02850	 Recall: 0.06297	NDCG: 0.05156
The time for epoch 45 is: train time = 00: 00: 48, test time = 00: 00: 10
Loss = 69.11360, F1-score: 0.040421 	 Precision: 0.02935	 Recall: 0.06488	NDCG: 0.05344
The time for epoch 50 is: train time = 00: 00: 47, test time = 00: 00: 10
Loss = 70.51320, F1-score: 0.041326 	 Precision: 0.02997	 Recall: 0.06656	NDCG: 0.05468
The time for epoch 51 is: train time = 00: 00: 47, test time = 00: 00: 10
Loss = 68.70372, F1-score: 0.041337 	 Precision: 0.02998	 Recall: 0.06656	NDCG: 0.05471
The time for epoch 52 is: train time = 00: 00: 47, test time = 00: 00: 10
Loss = 70.34286, F1-score: 0.041426 	 Precision: 0.03005	 Recall: 0.06666	NDCG: 0.05482
The time for epoch 53 is: train time = 00: 00: 47, test time = 00: 00: 10
Loss = 69.83237, F1-score: 0.041567 	 Precision: 0.03013	 Recall: 0.06698	NDCG: 0.05514
The time for epoch 54 is: train time = 00: 00: 48, test time = 00: 00: 10
Loss = 69.08521, F1-score: 0.041308 	 Precision: 0.02999	 Recall: 0.06633	NDCG: 0.05487
The time for epoch 55 is: train time = 00: 00: 48, test time = 00: 00: 10
Loss = 71.23681, F1-score: 0.041441 	 Precision: 0.03007	 Recall: 0.06663	NDCG: 0.05495
The time for epoch 56 is: train time = 00: 00: 47, test time = 00: 00: 10
Loss = 69.56957, F1-score: 0.041642 	 Precision: 0.03020	 Recall: 0.06703	NDCG: 0.05526
The time for epoch 57 is: train time = 00: 00: 47, test time = 00: 00: 10
Loss = 70.32664, F1-score: 0.041445 	 Precision: 0.03005	 Recall: 0.06675	NDCG: 0.05524
The time for epoch 58 is: train time = 00: 00: 48, test time = 00: 00: 10
Loss = 71.33122, F1-score: 0.041354 	 Precision: 0.03001	 Recall: 0.06649	NDCG: 0.05490
The time for epoch 59 is: train time = 00: 00: 48, test time = 00: 00: 10
Loss = 71.57766, F1-score: 0.041572 	 Precision: 0.03016	 Recall: 0.06686	NDCG: 0.05508
The time for epoch 60 is: train time = 00: 00: 48, test time = 00: 00: 10
Loss = 70.26724, F1-score: 0.041381 	 Precision: 0.03003	 Recall: 0.06652	NDCG: 0.05505
The time for epoch 61 is: train time = 00: 00: 48, test time = 00: 00: 10
Loss = 71.52420, F1-score: 0.041449 	 Precision: 0.03008	 Recall: 0.06661	NDCG: 0.05485
The time for epoch 62 is: train time = 00: 00: 48, test time = 00: 00: 10
Loss = 70.75553, F1-score: 0.041466 	 Precision: 0.03007	 Recall: 0.06677	NDCG: 0.05512
The time for epoch 63 is: train time = 00: 00: 48, test time = 00: 00: 10
Loss = 73.47623, F1-score: 0.041436 	 Precision: 0.03005	 Recall: 0.06669	NDCG: 0.05492
The time for epoch 64 is: train time = 00: 00: 48, test time = 00: 00: 10
Loss = 73.64090, F1-score: 0.041430 	 Precision: 0.03005	 Recall: 0.06670	NDCG: 0.05488
The time for epoch 65 is: train time = 00: 00: 48, test time = 00: 00: 10
Loss = 73.31149, F1-score: 0.041457 	 Precision: 0.03009	 Recall: 0.06662	NDCG: 0.05524
The time for epoch 66 is: train time = 00: 00: 48, test time = 00: 00: 10
Loss = 73.73279, F1-score: 0.041237 	 Precision: 0.02995	 Recall: 0.06616	NDCG: 0.05480
The time for epoch 67 is: train time = 00: 00: 48, test time = 00: 00: 10
Loss = 74.70129, F1-score: 0.040957 	 Precision: 0.02971	 Recall: 0.06593	NDCG: 0.05462
The time for epoch 68 is: train time = 00: 00: 48, test time = 00: 00: 10
Loss = 73.47211, F1-score: 0.041333 	 Precision: 0.03000	 Recall: 0.06643	NDCG: 0.05490
The time for epoch 69 is: train time = 00: 00: 49, test time = 00: 00: 10
Loss = 73.63886, F1-score: 0.040918 	 Precision: 0.02970	 Recall: 0.06575	NDCG: 0.05423
The time for epoch 70 is: train time = 00: 00: 48, test time = 00: 00: 10
Loss = 74.01769, F1-score: 0.040812 	 Precision: 0.02963	 Recall: 0.06557	NDCG: 0.05421
The time for epoch 71 is: train time = 00: 00: 48, test time = 00: 00: 10
Loss = 73.74196, F1-score: 0.040948 	 Precision: 0.02971	 Recall: 0.06587	NDCG: 0.05450
##########################################
Early stop is triggered at 71 epochs.
Results:
best epoch = 56, best recall = 0.06703301744791308, best ndcg = 0.05525589628153144
The best model is saved at ./ultragcn_yelp2018.pt
Training end!
END